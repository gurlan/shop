!function(){var a,s,n,t=2,e=!1,i="//m.imooc.com/";bindEventFuns={addConcern:function(){var a=$(this),s=$(this).data("id"),t=$(this).data("type");n({type:"get",url:"/api/wenda/follow",data:{id:s,type:1==t?"add":"del"},successCall:function(s){return s.login&&"0"==s.login?(location.href=i+"account/login",!1):void(s&&1==s.status&&(1==t?(a.data("type",2),a.find(".wd-r-icon").addClass("active-c"),$.msg("success","关注成功~"),a.find(".gz-txt").text("已关注")):(a.data("type",1),$.msg("success","已取消关注"),a.find(".gz-txt").text("关注"),a.find(".wd-r-icon").removeClass("active-c"))))}})},scrollFun:function(){},toFixedNav:function(){iscategory?(window.scrollY>10&&($(".fixed-wrap").addClass("fixed-top"),$(".fixed-title").removeClass("hide")),0==window.scrollY&&($(".fixed-wrap").removeClass("fixed-top"),$(".fixed-title").addClass("hide"))):(window.scrollY>457&&$(".wenda-nav").addClass("active-flxed"),window.scrollY<457&&$(".wenda-nav").removeClass("active-flxed"))},showMoreInfo:function(){var a=0,s="",i="",d=$(".list-w");return a=labelId,s=pageType,i="/api/wenda/listajax",e?!1:(loadImg(!0),void n({url:i,type:"get",data:{ajax:1,page:t,label:a,type:s},successCall:function(a){return loadImg(!1),0==a.data.list?(e=!0,$(".loading-more").addClass("hide"),!1):(t++,void bindEventFuns.generateHtml(a,d))}}))},generateHtml:function(a,s){var n=[],t="http://www.imooc.com/";1==a.status&&($.each(a.data.list,function(a,s){n.push('<li class="wd-block"><a href="../../../../../wenda/index.htm"/*tpa=https://m.imooc.com/wenda/detail?id='+s.id+'*/>'),n.push('<div class="left-img" style="background-image: url('+s.label_pic+')"></div>'),n.push('<div class="right-c">'),n.push('<p class="r-c-txt"><span>来自</span><span class="r-c-from">'+(s.labels_type||"")+"</span><span>"+s.answers+"个回答</span></p>"),n.push('<div class="r-c-content">'+s.title+"</div>"),0==s.answers?(n.push('<div class="wd-btns">'),n.push('<a data-alink="'+t+"/m/web/wenda/newanswer.html?bbsid="+s.id+'" class="wd-r-btn wd-hd"><span class="wd-r-icon imwap-Answer"></span><span>我要回答</span></a>'),n.push(1==s.followed?'<a  class="wd-r-btn wd-gz " data-type="1" data-id="'+s.id+'"><span class="wd-r-icon active-c imwap-collection"></span><span class="gz-txt">已关注</span></a>':'<a  class="wd-r-btn wd-gz" data-type="1" data-id="'+s.id+'"><span class="wd-r-icon imwap-collection"></span><span class="gz-txt">关注</span></a>'),n.push("</div>")):0==s.finished&&s.top_reply?(n.push('<p class="rs-tip">最赞的回答</p>'),n.push('<div class="rs-answer">'),s.top_reply&&n.push(s.top_reply.description),n.push("</div>")):s.finished>0&&s.top_reply?(n.push('<p class="rs-tip">已采纳回答</p>'),n.push('<div class="rs-answer">'),s.top_reply&&n.push(s.top_reply.description),n.push("</div>")):(n.push('<div class="wd-btns">'),n.push('<a data-alink="'+t+"/m/web/wenda/newanswer.html?bbsid="+s.id+'" class="wd-r-btn wd-hd"><span class="wd-r-icon imwap-Answer"></span><span>我要回答</span></a>'),n.push(1==s.followed?'<a  class="wd-r-btn wd-gz " data-type="1" data-id="'+s.id+'"><span class="wd-r-icon active-c imwap-collection"></span><span class="gz-txt">已关注</span></a>':'<a  class="wd-r-btn wd-gz" data-type="1" data-id="'+s.id+'"><span class="wd-r-icon imwap-collection"></span><span class="gz-txt">关注</span></a>'),n.push("</div>")),n.push("</div></a>"),n.push("</li>")}),s.append(n.join("")))},linkWd:function(a){var s=$(this).data("alink");a.preventDefault(),location.href=""!=userInfo&&userInfo?s:i+"account/login"},linkQu:function(a){var s=$(this).data("alink");a.preventDefault(),location.href=""!=userInfo&&userInfo?s:i+"account/login"}},s=function(){$(".list-w").delegate(".wd-gz","click",bindEventFuns.addConcern),$(window).on("touchmove",bindEventFuns.scrollFun),$(".js-show-more").on("click",bindEventFuns.showMoreInfo),$(".list-w").delegate(".wd-hd","click",bindEventFuns.linkWd),$(".js-addQu").on("click",bindEventFuns.linkQu),window.onscroll=bindEventFuns.toFixedNav},loadImg=function(a){var s='<img src="../../common/img/refresh.gif"/*tpa=https://m.imooc.com/static/wap/static/common/img/refresh.gif*/ alt="" class="load-img" />';a?($(".loading-more").addClass("hide"),$(".loding-m-wrap").html(s)):($(".loading-more").removeClass("hide"),$(".loding-m-wrap").html(""))},htmlEnCode=function(a){return a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=a.replace(/"/g,"&quot;"),a=a.replace(/'/g,"&#039;")},a=function(){s()},n=function(a){$.ajax({type:a.type||"post",url:a.url,data:a.data,dataType:a.dataType||"json",success:function(s){a&&a.successCall?a.successCall(s):0==s.error?(alert(s.msg?s.msg:"操作成功！"),setTimeout(function(){location.reload()},1500)):(alert(s.msg?s.msg:"操作失败！"),setTimeout(function(){location.reload()},1500))},error:function(s){a&&a.errorCall?a.errorCall():(alert(s.msg?s.msg:"通信失败，稍后再试！"),setTimeout(function(){location.reload()},1500))}})},a()}();